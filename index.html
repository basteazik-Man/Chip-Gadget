<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ß–∏–ø&–ì–∞–¥–∂–µ—Ç - –†–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∏</title>
    <meta name="description" content="–†–µ–º–æ–Ω—Ç —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤, –ø–ª–∞–Ω—à–µ—Ç–æ–≤, –Ω–æ—É—Ç–±—É–∫–æ–≤ –∏ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–æ–≤. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –ß–∏–ø&–ì–∞–¥–∂–µ—Ç.">
    
    <!-- PWA –ú–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="theme-color" content="#2563eb">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="/manifest.webmanifest">
    
    <!-- –î–ª—è Apple -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ß–∏–ø&–ì–∞–¥–∂–µ—Ç">
    <link rel="apple-touch-icon" href="/logo-192.png">
    
    <!-- –î–ª—è Windows -->
    <meta name="msapplication-TileColor" content="#2563eb">
    <meta name="msapplication-TileImage" content="/logo-144.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker -->
    <script>
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Service Worker
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º Service Worker
          navigator.serviceWorker.register('/sw.js', {
            scope: '/'
          })
          .then(registration => {
            console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ:', registration.scope);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              console.log('üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Service Worker');
              
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  console.log('üì¶ –ù–æ–≤—ã–π Service Worker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                }
              });
            });
          })
          .catch(error => {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
          });
          
          // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
          setInterval(() => {
            navigator.serviceWorker.getRegistration().then(registration => {
              if (registration) {
                registration.update();
              }
            });
          }, 60 * 60 * 1000); // –ö–∞–∂–¥—ã–π —á–∞—Å
        });
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ Service Worker
        navigator.serviceWorker.addEventListener('controllerchange', () => {
          console.log('üéÆ –ê–∫—Ç–∏–≤–Ω—ã–π Service Worker –∏–∑–º–µ–Ω–∏–ª—Å—è');
          window.location.reload();
        });
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞, –∑–∞–ø—É—â–µ–Ω–æ –ª–∏ –∫–∞–∫ PWA
      function checkPWA() {
        const isPWA = window.matchMedia('(display-mode: standalone)').matches ||
                     window.navigator.standalone === true;
        
        if (isPWA) {
          console.log('üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –∫–∞–∫ PWA');
          document.documentElement.setAttribute('data-pwa', 'true');
        }
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      checkPWA();
      
      // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è display-mode
      window.matchMedia('(display-mode: standalone)').addEventListener('change', checkPWA);
    </script>
    
    <!-- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ñ—Ñ–ª–∞–π–Ω/–æ–Ω–ª–∞–π–Ω —Å–æ–±—ã—Ç–∏–π -->
    <script>
      window.addEventListener('online', () => {
        console.log('üåê –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        document.dispatchEvent(new CustomEvent('connectionRestored'));
      });
      
      window.addEventListener('offline', () => {
        console.log('‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ');
        document.dispatchEvent(new CustomEvent('connectionLost'));
      });
    </script>
  </body>
</html>